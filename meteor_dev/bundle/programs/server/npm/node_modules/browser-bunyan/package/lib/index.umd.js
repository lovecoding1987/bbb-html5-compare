!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r(e.bunyan={})}(this,function(e){var r={trace:10,debug:20,info:30,warn:40,error:50,fatal:60},c={};function l(e){return"string"==typeof e?r[e.toLowerCase()]:e}Object.keys(r).forEach(function(e){c[r[e]]=e});var f="call-stack-error";function h(r){if(null==r)return r;if(Array.isArray(r))return r.slice();if("object"!=typeof r)return r;var t={};return Object.keys(r).forEach(function(e){t[e]=r[e]}),t}function u(e){return void 0===e?"undefined":null===e?"null":Array.isArray(e)?"[ "+e.map(function(e){return u(e)}).join(", ")+" ]":"object"==typeof e?JSON.stringify(e):"function"==typeof e?"[Function: "+e.name+"]":"boolean"==typeof e||"number"==typeof e?e:"'"+e.toString()+"'"}function v(e){var r=arguments;if("string"!=typeof e){for(var t=new Array(arguments.length),s=0;s<arguments.length;s++)t[s]=u(r[s]);return t.join(" ")}for(var i=1,n=arguments,o=n.length,l=String(e).replace(/%[sdj%]/g,function(e){if("%%"===e)return"%";if(o<=i)return e;switch(e){case"%s":return String(n[i++]);case"%d":return Number(n[i++]);case"%j":try{return JSON.stringify(n[i++])}catch(e){return"[Circular]"}default:return e}}),a=n[i];i<o;a=n[++i])l+=null===a||"object"!=typeof a?" "+a:" "+u(a);return l}var p={};function y(e,r){if(r){if(p[r])return;p[r]=!0}console.error(e+"\n")}function m(){var t=[];return function(e,r){return r&&"object"==typeof r?-1!==t.indexOf(r)?"[Circular]":(t.push(r),r):r}}var t={trace:10,debug:20,info:30,warn:40,error:50,fatal:60};Object.keys(t).forEach(function(e){});var d=function(){};d.prototype.write=function(e){e.level<30?console.log(e):e.level<40?console.info(e):e.level<50?console.warn(e):console.error(e),e.err&&e.err.stack&&console.error(e.err.stack),e.obj&&console.log(e.obj)};var s=function e(r,t,s){var i,n,o,l,a=this;if(!(this instanceof e))return new e(r,t);if(void 0!==t&&(i=r,r=t,!(i instanceof e)))throw new TypeError("invalid Logger creation: do not pass a second arg");if(!r)throw new TypeError("options (object) is required");if(i){if(r.name)throw new TypeError("invalid options.name: child cannot set logger name")}else if(!r.name)throw new TypeError("options.name (string) is required");if(r.stream&&r.streams)throw new TypeError('cannot mix "streams" and "stream" options');if(r.streams&&!Array.isArray(r.streams))throw new TypeError("invalid options.streams: must be an array");if(r.serializers&&("object"!=typeof r.serializers||Array.isArray(r.serializers)))throw new TypeError("invalid options.serializers: must be an object");if(i&&s){this._level=i._level,this.streams=i.streams,this.serializers=i.serializers,this.src=i.src,n=this.fields={};var c=Object.keys(i.fields);for(l=0;l<c.length;l++)o=c[l],n[o]=i.fields[o];var f=Object.keys(r);for(l=0;l<f.length;l++)o=f[l],n[o]=r[o]}else{if(i){for(this._level=i._level,this.streams=[],l=0;l<i.streams.length;l++){var u=h(i.streams[l]);a.streams.push(u)}this.serializers=h(i.serializers),this.src=i.src,this.fields=h(i.fields),r.level&&this.level(r.level)}else this._level=Number.POSITIVE_INFINITY,this.streams=[],this.serializers=null,this.src=!1,this.fields={};r.stream?this.addStream({type:"stream",stream:r.stream,level:r.level}):r.streams?r.streams.forEach(function(e){a.addStream(e,r.level)}):i&&r.level?this.level(r.level):i||this.addStream({type:"raw",stream:new d,level:r.level}),r.serializers&&this.addSerializers(r.serializers),r.src&&(this.src=!0),delete(n=h(r)).stream,delete n.level,delete n.streams,delete n.serializers,delete n.src,this.serializers&&this._applySerializers(n),Object.keys(n).forEach(function(e){a.fields[e]=n[e]})}};function i(a){return function(){var n=this;var o=null,l=arguments,e=null;if(0===arguments.length)return this._level<=a;this._level>a||(e=function(e){var r;l=e[0]instanceof Error?(o={err:n.serializers&&n.serializers.err?n.serializers.err(e[0]):g.err(e[0])},r={err:!0},1===e.length?[o.err.message]:Array.prototype.slice.call(e,1)):"object"!=typeof e[0]&&null!==e[0]||Array.isArray(e[0])?(o=null,Array.prototype.slice.call(e)):(o=e[0],1===e.length&&o.err&&o.err instanceof Error?[o.err.message]:Array.prototype.slice.call(e,1));var t=h(n.fields);t.level=a;var s=o?h(o):null;if(s&&(n.serializers&&n._applySerializers(s,r),Object.keys(s).forEach(function(e){t[e]=s[e]})),t.levelName=c[a],t.msg=l.length?v.apply(n,l):"",t.time||(t.time=new Date),n.src&&!t.src)try{throw new Error(f)}catch(e){var i=e.stack?function(e,r){var t=e.split("\n");t[0]&&0<=t[0].indexOf(f)&&t.shift();var s=t[r],i=null;if(s){var n=/^\s*(at|.*@)\s*(.+)?$/.exec(s);i=Array.isArray(n)&&n[2]?n[2]:s}return i}(e.stack,2):"";i||p.src||y("Unable to determine src line info","src"),t.src=i||""}return t.v=1,t}(l),this._emit(e))}}s.prototype.addStream=function(e,r){void 0===r&&(r=30),(e=h(e)).type="raw",e.level=l(e.level||r),e.level<this._level&&(this._level=e.level),this.streams.push(e),delete this.haveNonRawStreams},s.prototype.addSerializers=function(t){var s=this;this.serializers||(this.serializers={}),Object.keys(t).forEach(function(e){var r=t[e];if("function"!=typeof r)throw new TypeError(v('invalid serializer for "%s" field: must be a function',e));s.serializers[e]=r})},s.prototype.child=function(e,r){return new this.constructor(this,e||{},r)},s.prototype.level=function(e){if(void 0===e)return this._level;for(var r=l(e),t=this.streams.length,s=0;s<t;s++)this.streams[s].level=r;this._level=r},s.prototype.levels=function(e,r){var t;if(void 0===e)return this.streams.map(function(e){return e.level});if("number"==typeof e){if(void 0===(t=this.streams[e]))throw new Error("invalid stream index: "+e)}else{for(var s=this.streams.length,i=0;i<s;i++){var n=this.streams[i];if(n.name===e){t=n;break}}if(!t)throw new Error(v('no stream with name "%s"',e))}if(void 0===r)return t.level;var o=l(r);(t.level=o)<this._level&&(this._level=o)},s.prototype._applySerializers=function(t,e){var s=this;Object.keys(this.serializers).forEach(function(r){if(!(void 0===t[r]||e&&e[r]))try{t[r]=s.serializers[r](t[r])}catch(e){y(v('bunyan: ERROR: Exception thrown from the "%s" Bunyan serializer. This should never happen. This is a bugin that serializer function.\n%s',r,e.stack||e)),t[r]=v('(Error in Bunyan log "%s" serializer broke field. See stderr for details.)',r)}})},s.prototype._emit=function(r,e){var t,s,i,n;if(void 0===this.haveNonRawStreams)for(this.haveNonRawStreams=!1,t=0;t<this.streams.length;t++)if(!this.streams[t].raw){this.haveNonRawStreams=!0;break}if(e||this.haveNonRawStreams)try{s=JSON.stringify(r,m())+"\n"}catch(e){var o=e.stack.split(/\n/g,2).join("\n");y('bunyan: ERROR: Exception in `JSON.stringify(rec)`. You can install the "safe-json-stringify" module to have Bunyan fallback to safer stringification. Record:\n'+(i=v("%s\n%s",r,e.stack),n||(n="    "),n+i.split(/\r?\n/g).join("\n"+n)),o),s=v("(Exception in JSON.stringify(rec): %j. See stderr for details.)\n",e.message)}if(e)return s;var l=r.level;for(t=0;t<this.streams.length;t++){var a=this.streams[t];a.level<=l&&a.stream.write(r)}return s},s.prototype.trace=i(10),s.prototype.debug=i(20),s.prototype.info=i(30),s.prototype.warn=i(40),s.prototype.error=i(50),s.prototype.fatal=i(60);var g={err:function(e){return e&&e.stack?{message:e.message,name:e.name,stack:function e(r){var t=r.stack||r.toString();if(r.cause&&"function"==typeof r.cause){var s=r.cause();s&&(t+="\nCaused by: "+e(s))}return t}(e),code:e.code,signal:e.signal}:e}};var n={trace:10,debug:20,info:30,warn:40,error:50,fatal:60},b={};Object.keys(n).forEach(function(e){b[n[e]]=e});var o={levels:{trace:"color: DeepPink",debug:"color: GoldenRod",info:"color: DarkTurquoise",warn:"color: Purple",error:"color: Crimson",fatal:"color: Black"},def:"color: DimGray",msg:"color: SteelBlue",src:"color: DimGray; font-style: italic; font-size: 0.9em"},a=function(e){void 0===e&&(e={});var r=e.logByLevel;void 0===r&&(r=!1);var t=e.css;void 0===t&&(t=o),this.logByLevel=r,this.css=t};a.prototype.write=function(e){var r,t,s=this.css.def,i=this.css.msg,n=this.css.src,o=e.childName?e.name+"/"+e.childName:e.name,l=b[e.level],a=(Array(6-l.length).join(" ")+l).toUpperCase();t=this.logByLevel?(10===e.level?l="debug":60===e.level&&(l="error"),"function"==typeof console[l]?console[l]:console.log):console.log,r=e.level<20?this.css.levels.trace:e.level<30?this.css.levels.debug:e.level<40?this.css.levels.info:e.level<50?this.css.levels.warn:e.level<60?this.css.levels.error:this.css.levels.fatal;var c=function(e,r){return Array(r+1-(e+"").length).join("0")+e},f=[];f.push("[%s:%s:%s:%s] %c%s%c: %s: %c%s "+(e.src?"%c%s":"")),f.push(c(e.time.getHours(),2)),f.push(c(e.time.getMinutes(),2)),f.push(c(e.time.getSeconds(),2)),f.push(c(e.time.getMilliseconds(),4)),f.push(r),f.push(a),f.push(s),f.push(o),f.push(i),f.push(e.msg),e.src&&(f.push(n),f.push(e.src)),t.apply(console,f),e.err&&e.err.stack&&t.call(console,"%c%s,",r,e.err.stack),e.obj&&t.call(console,e.obj)},a.getDefaultCss=function(){return o};var w={trace:10,debug:20,info:30,warn:40,error:50,fatal:60},j={};Object.keys(w).forEach(function(e){j[w[e]]=e});var k=function(e){void 0===e&&(e={});var r=e.logByLevel;void 0===r&&(r=!1),this.logByLevel=r};k.prototype.write=function(e){var r,t=e.childName?e.name+"/"+e.childName:e.name,s=j[e.level],i=(Array(6-s.length).join(" ")+s).toUpperCase();r=this.logByLevel?(10===e.level?s="debug":60===e.level&&(s="error"),"function"==typeof console[s]?console[s]:console.log):console.log;var n=function(e,r){return Array(r+1-(e+"").length).join("0")+e},o="["+n(e.time.getHours(),2)+":";o+=n(e.time.getMinutes(),2)+":",o+=n(e.time.getSeconds(),2)+":",o+=n(e.time.getMilliseconds(),4)+"] ",o+=i+": ",o+=t+": ",o+=e.msg,e.src&&(o+=" ("+e.src+")"),r.call(console,o),e.err&&e.err.stack&&r.call(console,e.err.stack),e.obj&&r.call(console,e.obj)},e.TRACE=10,e.DEBUG=20,e.INFO=30,e.WARN=40,e.ERROR=50,e.FATAL=60,e.resolveLevel=l,e.levelFromName=r,e.nameFromLevel=c,e.stdSerializers=g,e.Logger=s,e.createLogger=function(){for(var e=[],r=arguments.length;r--;)e[r]=arguments[r];return new(Function.prototype.bind.apply(s,[null].concat(e)))},e.safeCycles=m,e.ConsoleFormattedStream=a,e.ConsoleRawStream=d,e.ConsolePlainStream=k});
//# sourceMappingURL=index.umd.js.map
